<html>
<head>
    <meta charset="utf-8">
    <title>Editor</title>
</head>
<body>

<div class="container">
    <div id="container" class="col-md-8 col-md-offset-2">  </div>
</div>

<script src="https://fb.me/react-15.1.0.js"></script>
<script src="https://fb.me/react-dom-15.1.0.js"></script>
<script src="http://fb.me/JSXTransformer-0.12.1.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script type="text/jsx">
    var App = React.createClass({
        getInitialState: function() {
            return {
                tables: [],
                data:[],
                dburl:'',
                user:'',
                pwd:''
            }
        },
        handleChange: function(e) {

            this.setState({[e.target.name]: e.target.value});
            console.log(this.state.dburl)
        },
        readTables: function (name) {
            var sendas = {
                method: 'GET',
                url: 'http://localhost:8081/editor/tables/'+name,
                json: true
            };
            console.log("read tabke")
            axios(sendas)
                .then(function(response){
                    console.log(response.data); // ex.: { user: 'Your User'}
                    console.log(response.status); // ex.: 200
                });
        },
        opendb:function (e) {

            var data = JSON.stringify({'db': this.state.dburl, 'user': this.state.user, 'pwd': this.state.pwd})

            console.log("data" + data)
            var tables = {
                method: 'GET',
                url: 'http://localhost:8081/editor/tables',
                json: true
            };
            var sendas = {
                method: 'POST',
                url: 'http://localhost:8081/editor/open',
                data: data,
                headers: {
                    'Content-Type': 'application/json'
                },
                json: true
            };
            axios(sendas)
                .then(function(response){
                    axios(tables)
                        .then(function(response){
                            console.log(response.data);
                            this.setState({tables:response.data})
                            console.log(response.status); // ex.: 200
                        }.bind(this));
                    console.log(response.status); // ex.: 200
                }.bind(this));
        },

        render: function(){
            var topp={width: '100%'}
            var left={float:'left',width: '20%'}
            var right={float:'left'}
            return (

            <div style={topp}>
                <div style={{height:'30px'}}>Connection <input type="edit" name="dburl" size="35" onChange={this.handleChange} />
                    user <input type="edit" name="user" size="15" onChange={this.handleChange} /> password <input type="edit" name="pwd" size="15" onChange={this.handleChange} />
                    <span size="2"></span> <input type="button" value="Submit" onClick={this.opendb} ></input>
                </div>
                <div>
                <div style={left}>
                    <p>Table</p>
                    <ul>{this.state.tables.map((table) => <li> <button onClick={this.readTables.bind(this, table.toString())}>)>{table}</button></li>)}

                    </ul>
                </div>
                <div style={right}>
                    <p>Data</p>
                </div>
                </div>
            </div>

            );
        }
    });
    ReactDOM.render(<App />, document.querySelector('#container'))
</script>
</body>
</html>